<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Install Le Libido</title>
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#064D95" />
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --gold: #e1bf78;
      --red: #950606;
      --blue: #064D95;
      --green: #06954E;
      --white: #ffffff;
      --charcoal: #0d0d0d;
    }

    body {
      margin: 0;
      font-family: 'Montserrat', sans-serif;
      background-color: var(--charcoal);
      color: var(--white);
      text-align: center;
      padding: 0;
      border: 5px solid var(--gold);
      border-radius: 16px;
    }

    .container {
      padding: 40px 20px;
    }

    img.logo {
      max-width: 180px;
      margin-top: 20px;
    }

    .app-description {
      max-width: 700px;
      margin: 20px auto 30px auto;
      font-size: 1rem;
      line-height: 1.6;
    }

    .install-button {
      background-color: var(--red);
      color: var(--white);
      border: none;
      padding: 14px 28px;
      font-size: 1.2rem;
      border-radius: 8px;
      cursor: pointer;
      animation: pulse 2s infinite;
      margin-bottom: 40px;
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.08); }
      100% { transform: scale(1); }
    }

    .how-it-works {
      background-color: var(--blue);
      border: 4px solid var(--green);
      border-radius: 12px;
      max-width: 800px;
      margin: 0 auto 60px;
      padding: 30px 20px;
      text-align: left;
    }

    .how-it-works h2 {
      text-align: center;
      font-size: 1.8rem;
      margin-bottom: 20px;
    }

    .how-it-works ol {
      padding-left: 20px;
      font-size: 1rem;
      line-height: 1.7;
    }

    .ios-instructions {
      background-color: var(--gold);
      color: black;
      font-size: 0.9rem;
      padding: 15px;
      margin-top: 30px;
      border-radius: 10px;
      display: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <img src="le-libido-icon.png" alt="Le Libido App Icon" class="logo" />

    <div class="app-description">
      Le Libido is the dating app that only works when you‚Äôre out in the world. There‚Äôs no ghosting. No swiping. Just instant IRL connection with real people, in real places, in real time.
    </div>

    <button class="install-button" id="installBtn">Install the App</button>

    <div class="how-it-works">
      <h2>üî• How It Works</h2>
      <ol>
        <li><strong>Take our hilariously sexy 10-question quiz</strong><br/>Discover who you‚Äôre compatible with and why they might just be your perfect match.</li>
        <li><strong>Choose your mode: Verified or Anonymous</strong><br/>Then complete your profile. Keep it mysterious, or show off who you are and share exactly what you‚Äôre looking for.</li>
        <li><strong>Scope out the scene</strong><br/>Peek at who‚Äôs hot at each venue before you go, or check into a bar, caf√©, or restaurant to get checked in and see who‚Äôs checking you out.</li>
        <li><strong>Make your move</strong><br/>Tap ‚ÄúApproach‚Äù to see who wants to meet you right now, or keep your location private until you ‚ÄúInvite‚Äù someone and give them permission to approach you.</li>
        <li><strong>Slide into real life</strong><br/>Use our 1-on-1 or group chat feature to set up your date IRL, and skip the small talk.</li>
      </ol>
    </div>

    <div id="iosInstructions" class="ios-instructions">
      On Safari? Tap the <strong>Share</strong> icon and then <strong>"Add to Home Screen"</strong> to install Le Libido.
    </div>
  </div>

  <script>
    let deferredPrompt;

    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      document.getElementById('installBtn').style.display = 'inline-block';
    });

    document.getElementById('installBtn').addEventListener('click', async () => {
      // Request Geolocation
      if ('geolocation' in navigator) {
        navigator.geolocation.getCurrentPosition(
          (pos) => console.log('Geo success:', pos),
          (err) => console.error('Geo error:', err),
          { enableHighAccuracy: true }
        );
      }

      // Request Push Notification Permission
      if ('Notification' in window && Notification.permission !== 'granted') {
        await Notification.requestPermission();
      }

      // Trigger PWA install prompt
      if (deferredPrompt) {
        deferredPrompt.prompt();
        deferredPrompt.userChoice.then(choice => {
          console.log('User install choice:', choice.outcome);
        });
        deferredPrompt = null;
      }
    });

    // Show iOS instructions if on Safari
    function isiOS() {
      return /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
    }

    function isSafari() {
      return /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
    }

    if (isiOS() && isSafari()) {
      document.getElementById('iosInstructions').style.display = 'block';
    }

    // Register service worker
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/service-worker.js').then(() => {
        console.log('Service Worker registered');
      });
    }
  </script>
</body>
</html>
